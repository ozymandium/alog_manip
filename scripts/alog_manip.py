#!/usr/bin/python
"""
collection of functions for manipulating *.alogs

Author: Robert Cofield
Created 6/6/2012
Python v2.7.3, Ubuntu Precise
"""

#############################################################################################


def pullByStr2new(alogSrc, alogTgt, desStr):
    """
    finds msgs with a string in meas type or source and creates a separate *.alog file from those msgs

    INPUTS:
        alogSrc     ::  absolute path of source *.alog file
        alogTgt     ::  absolute path of desired target *.alog file
        desStr      ::  messages containing this string will be copied

    """
    import csv, os

    curdir = os.getcwd()
    os.chdir('/') # go to root so that reader can use abs pathname
    src = open(alogSrc, 'rU') # read source alogs
    tgt = open(alogTgt, 'w')
    os.chdir(curdir)
    
    tgt.write('%% Generated by alog_manip.pullByStr2new\n')
    
    for line in filterData(src, desStr):
        tgt.write(line + '\n')


def filterData(alog_rd, desStr):
    """
    yields msgs in list format which contain a desired string in the source (third) column

    alog_rd     ::  reader object from source *.alog file
    desStr      ::  string we're looking for
    """

    for line in alog_rd:
        line = str(line) # now each line is a string
        line = line.rstrip()
        for desired in desStr:
            if (desStr in line) or ('%%' in line):
                yield line


###########################################################################################

def agwn(alogSrc, alogTgt, meas):
    """
    Adds gaussian white noise to specific measurements in an *.alog file.
    """
    import csv, os

    curdir = os.getcwd()