TO DO:

-implement reconstructLine in all other functions

-replace all loops with scipy optimized iteration tools